@page "/test/setup"
@page "/setup/v1/covercalibrator/{InstanceID:int}/setup"

<body>
    <fieldset>
        <legend>Calibrator Settings</legend>
        <div class="grid-container-two">
            <div class="grid-item-right">
                <span>Max Brightness:</span>
            </div>
            <div class="grid-item-left">
                <input type="number" class="number-narrow"
                       min="1" max="2147483647" @bind="@MaxBrightness">
            </div>

            <div class="grid-item-right">
                <span>Stabilization Time:</span>
            </div>
            <div class="grid-item-left">
                <input type="number" step="0.1" class="number-narrow"
                       min="0.0" max="100.0" @bind="CalStabTime">
            </div>

            <div class="grid-item-right">
                <span>Calibrator Status:</span>
            </div>
            <div class="grid-item-left">
                <select id="devicetype" @bind="CalStatus" style="width:100%;max-width:21ch;">
                    @foreach (var calStatus in (ASCOM.Alpaca.Interfaces.CalibratorStatus[])Enum.GetValues(typeof(ASCOM.Alpaca.Interfaces.CalibratorStatus)))
                    {
                        <option value="@calStatus">@calStatus.ToString()</option>
                    }
                </select>
            </div>

            <div class="grid-item-right">
            </div>
            <div class="grid-item-left">
                <button class="btn" @onclick="SaveDeviceSettings" >Save</button>
            </div>
        </div>
    </fieldset>

    <fieldset>
        <legend>Cover Settings</legend>
        <div class="grid-container-two">

            <div class="grid-item-right">
                <span>Opening Time:</span>
            </div>
            <div class="grid-item-left">
                <input type="number" step="0.1" class="number-narrow"
                       min="0.0" max="100.0" @bind="OpeningTime">
            </div>

            <div class="grid-item-right">
                <span>Cover Status:</span>
            </div>
            <div class="grid-item-left">
                <select id="devicetype" @bind="CoverStatus" style="width:100%;max-width:21ch;">
                    @foreach (var coverStatus in (ASCOM.Alpaca.Interfaces.CoverStatus[])Enum.GetValues(typeof(ASCOM.Alpaca.Interfaces.CoverStatus)))
                    {
                        <option value="@coverStatus">@coverStatus.ToString()</option>
                    }
                </select>
            </div>
        </div>
    </fieldset>
</body>

@code {
    [Parameter]
    public int InstanceID { get; set; }

    public int MaxBrightness
    {
        get
        {
            return DeviceManager.coverCalibrator.MaxBrightnessValue;
        }
        set
        {
            DeviceManager.coverCalibrator.MaxBrightnessValue = value;
        }
    }

    public double CalStabTime
    {
        get
        {
            return DeviceManager.coverCalibrator.CalibratorStablisationTimeValue;
        }
        set
        {
            DeviceManager.coverCalibrator.CalibratorStablisationTimeValue = value;
        }
    }

    public ASCOM.Alpaca.Interfaces.CalibratorStatus CalStatus
    {
        get
        {
            return DeviceManager.coverCalibrator.CalibratorStateInitialisationValue;
        }
        set
        {
            DeviceManager.coverCalibrator.CalibratorStateInitialisationValue = value;
        }
    }

    public double OpeningTime
    {
        get
        {
            return DeviceManager.coverCalibrator.CoverOpeningTimeValue;
        }
        set
        {
            DeviceManager.coverCalibrator.CoverOpeningTimeValue = value;
        }
    }

    public ASCOM.Alpaca.Interfaces.CoverStatus CoverStatus
    {
        get
        {
            return DeviceManager.coverCalibrator.CoverStateInitialisationValue;
        }
        set
        {
            DeviceManager.coverCalibrator.CoverStateInitialisationValue = value;
        }
    }

    public void SaveDeviceSettings()
    {
        DeviceManager.coverCalibrator.WriteProfile();
    }
}